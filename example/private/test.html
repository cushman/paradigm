<html>
<head>
<script src='js/mootools.js'> </script>
<script src="js/paradigm.js"> </script>
</head>
<body> 
	<input id="session_field" type="text"></input>
	{%	
		_sessid = null
		current_user = null
		set_user =(data)->
			current_user = data
			if current_user
				console.log current_user
		if current_user = Cookie.read '_sessid'		
			$get_current_user callback:set_user
		else
			$get_sessid callback:(id)->
				Cookie.write '_sessid', id
				if not current_user
					$get_current_user callback:set_user
				
			
	%}
	{=target=}
	{% 
		autoUpdate =(obj, text)->
			if obj
				$(obj._where).set('text',obj._data)
			#setTimeout (->$randomfloat callback:autoUpdate, where:$('target')),1000
		autoUpdate()
	%}
	Enter your email: <input id="email_field" type="text"></input>
	{$	
		$('email_field').set 'value', 'test'
		$('email_field').addEvent 'change',(event)-> update_this_user(email:event.target.value)
	$}
	
</body>
</html>